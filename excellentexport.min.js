/**
 * ExcellentExport 2.0.4
 * A client side Javascript export to Excel.
 *
 * @author: Jordi Burgos (jordiburgos@gmail.com), Mirek Vales
 * @fork-url: https://github.com/mirekvales/excellentexport
 * @base-url: https://github.com/jmaister/excellentexport
 */
function getDocument(e){return window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:xmlhttp=new ActiveXObject("Microsoft.XMLHTTP"),xmlhttp.open("GET",e,!1),xmlhttp.send(),xmlhttp.responseText}(function(e){"use strict";var t=function(){function e(e,t,n){t=t||"",n=n||512;var o,r=window.atob(e),c=[];for(o=0;o<r.length;o+=n){var l,s=r.slice(o,o+n),i=new Array(s.length);for(l=0;l<s.length;l+=1)i[l]=s.charCodeAt(l);var x=new window.Uint8Array(i);c.push(x)}var a=new window.Blob(c,{type:t});return a}function t(t,n,o,r){var c;if(window.navigator.msSaveBlob)return c=e(n,o),window.navigator.msSaveBlob(c,r),!1;if(window.URL.createObjectURL){c=e(n,o);var l=window.URL.createObjectURL(c);t.href=l}else{var s="data:"+o+";base64,"+n;t.download=r,t.href=s}return!0}var n="2.0.3",o={excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'},r={excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><style type="text/css">{styledefinition}</style></head><body>{tables}</body></html>'},c=",",l="\r\n",s=function(e){return window.btoa(window.unescape(encodeURIComponent(e)))},i=function(e,t){return e.replace(new RegExp("{(\\w+)}","g"),function(e,n){return t[n]})},x=function(e){return e.nodeType?e:document.getElementById(e)},a=function(e){var t=e,n=e.indexOf(c)!==-1||e.indexOf("\r")!==-1||e.indexOf("\n")!==-1,o=e.indexOf('"')!==-1;return o&&(t=t.replace(/"/g,'""')),(n||o)&&(t='"'+t+'"'),t},m=function(e){var t,n,o,r,s="";for(t=0;t<e.rows.length;t+=1){for(o=e.rows[t],n=0;n<o.cells.length;n+=1)r=o.cells[n],s=s+(n?c:"")+a(r.textContent.trim());s+=l}return s},f={version:function(){return n},excel:function(e,n,r){n=x(n);var c={worksheet:r||"Worksheet",table:n.innerHTML},l=s(i(o.excel,c));return t(e,l,"application/vnd.ms-excel","export.xls")},excelAll:function(e,n){for(var o=document.getElementsByTagName("table"),c="",l=0;l<o.length;l+=1)c+="<table>"+o[l].innerHTML+"</table>";var i=r.excel.replace("{tables}",c).replace("{worksheet}","Export").replace("{styledefinition}",getDocument(n)),x=s(i);return t(e,x,"application/vnd.ms-excel","export.xls")},csv:function(e,n,o,r){void 0!==o&&o&&(c=o),void 0!==r&&r&&(l=r),n=x(n);var i="\ufeff"+m(n),a=s(i);return t(e,a,"application/csv","export.csv")}};return f}();"function"==typeof define&&define.amd?define(function(){return t}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.ExcellentExport=t):e.ExcellentExport=t})(this);